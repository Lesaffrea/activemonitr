---
title: "Reducing the threat of imported infectious disease outbreaks with active monitoring"
author: "Nicholas G Reich, Neil M Vora, Jay K Varma, Justin Lessler"
date: "April, 2016"
output:
  word_document:
    fig_caption: yes
    fig_height: 5
    fig_width: 5
    md_extensions: +implicit_figures
  pdf_document:
    fig_caption: yes
    fig_height: 5
    fig_width: 5
    md_extensions: +implicit_figures
csl: the-new-england-journal-of-medicine.csl
bibliography: active-monitoring.bib
---

```{r global-options, include=FALSE}
knitr::opts_chunk$set(fig.width=7.5, fig.height=5, fig.path='figs/',
                      echo=FALSE, warning=FALSE, message=FALSE)

my_round <- function(x, k) format(round(x, k), nsmall=k)
```

```{r load-results}
library(activeMonitr)
library(gridExtra)
library(ggplot2)
library(tidyr)
library(scales)
library(knitr)
theme_set(theme_bw())
data("pstr_gamma_params_ebola")
data("pstr_gamma_params_mers")
data("pstr_gamma_params_smallpox")
source('../analysis-code/inc-per-mcmc.R')
```


# Abstract

__Background__    
Active monitoring is our first line of defense against deadly emerging pathogens (e.g., Ebola, MERS-CoV) and bioterror threats (e.g., smallpox). Balancing its cost and performance is critical in forming biosecurity policy. 

__Methods__    
We model the risk of individuals becoming symptomatic from a disease of interest and other causes using a probabilistic model, and estimate the resulting risks and costs associated with active monitoring programs. As a case-study, we analyze data on the number of individuals actively monitored by New York City during the West African Ebola outbreak and costs associated with the city's overall Ebola response.

__Results__ 

During the west African Ebola outbreak, CDC recommended active monitoring for 21 days. This corresponds to about `r my_round(21/mean(pstr_gamma_params_ebola$median),1)` times the estimated median incubation period for Ebola of `r my_round(mean(pstr_gamma_params_ebola$median),1)` days. To tolerate the same level of absolute risk in a future outbreak of either MERS-CoV or Smallpox, our model suggests that a duration of active monitoring could be set at less than 2 times the median incubation period for each pathogen. New York City spent over $1.9 million on their active monitoring program, which monitored 5,321 individuals over 12 months. 

__Conclusions__    
Active monitoring can save lives and minimize resource-intensive response to catastrophic events, but the costs of monitoring and responding to false alarms are also significant. These costs can be minimized by using simple targeted strategies that are evidence-based. Resources can be most effectively allocated by using exposure-risk categories to modify the duration or intensity of active monitoring, as reflected in current CDC recommendations. Encouraging travelers to take recommended health precautions to avoid common travel-associated illnesses would further reduce false alarms.


# Introduction

[\\]:(### Definition, history, and potential applications of active monitoring for infectious disease (100w))

The west African Ebola virus disease (Ebola) outbreak was an unprecedented public health emergency that underscored the ease with which pathogens spread in today’s interconnected world. To improve rapid identification and evaluation of individuals infected with Ebola, on October 27, 2014, the U.S. Centers for Disease Control and Prevention (CDC) recommended active monitoring of individuals entering the United States who had potentially been exposed to Ebola virus. Individuals under active monitoring were asked to contact local health authorities every day for 21 days after their last potential exposure to report their health status. 

During November 2014–March 2015, over 10,000 individuals were monitored for Ebola in the United States.[@StehlingAriza:2015vd] 
Public health agencies discontinued active monitoring in February 2016, once 45 days had passed since the last Ebola-affected country was declared free of Ebola virus transmission.[@CentersforDiseaseControlandPrevention:lyxYF_Hp] 
Over 20% of all persons actively monitored for Ebola in the United States were monitored in New York City (NYC), more than any other jurisdiction.[@StehlingAriza:2015vd]

Active monitoring has shown promise as a tool in preventing and responding to outbreaks of pathogens that pose a grave threat to public health. It could play an important role in containing outbreaks of rapidly spreading emerging pathogens, occurring either naturally or via a bioterrorist attack.

The decision to implement active monitoring is based on an assessment of the risk posed by a pathogen and the ability of active monitoring to reduce that risk. Key considerations include the potential size of an outbreak, the pathogen's transmissibility, its pathogenicity, and the relationship between the time of symptom onset and becoming infectious.[@Fraser:2004ci] Ebola, Middle East Respiratory Syndrome Coronavirus (MERS-CoV), and smallpox are examples of pathogens for which active monitoring could play a pivotal role in preventing a large-scale outbreak.

Active monitoring programs must balance conflicting priorities. The central goals of these programs are to identify, isolate, and treat infected individuals quickly. Setting an active monitoring period many times longer than any known incubation period of the pathogen of concern could virtually guarantee that all infected individuals would exhibit symptoms while being monitored. However, such a program would be unreasonably expensive and incur many financial and social costs through frequent responses to false positive cases. Evidence-based monitoring periods, and appropriate tailoring of the monitoring intensity to disease risk can be used to balance costs with biosecurity risks. 

In an age of emerging disease threats, establishing an evidence base and analytic approach for optimizing active monitoring programs is vital to public health. Here we present an empirical framework for evaluating the risks and costs associated with active monitoring. We apply this framework to Ebola, MERS-CoV, and smallpox using data on the natural history of these diseases and data from the Ebola response of the NYC Department of Health and Mental Hygiene (DOHMH). 


# Methods

### Estimating the incubation period distribution
The incubation period of a disease is the duration of time between exposure to the pathogen and symptom onset.[@Brookmeyer:2005bc] This characteristic is often imperfectly observed in real-world data collection settings.[@Reich:2009jq;@Lessler:2009ub] We obtained previously published incubation period observations on 152 cases of Ebola in Guinea [@Faye:2015jc], 170 laboratory-confirmed cases of MERS-CoV in South Korea[@Virlogeux:2016ty] and 362 cases of smallpox[@Litvinjenko:1972vp;@Mack:1972jc;@Nishiura:2009dh]. We fit parametric distributions to the observed incubation period data using maximum likelihood techniques (see Supplement). We ran sensitivity analyses to evaluate the influence of several outlying observations in the Ebola dataset.
 
### A model for active monitoring outcomes
We developed a probabilistic model for evaluating the likelihood that a monitored individual would become symptomatic with the disease of interest at different stages of monitoring. Figure 1 presents the model schema, which involves a monitored individual having one of four outcomes: (1) no symptoms warranting clinical follow-up, (2) no symptomatic infection with the disease of interest, but occurrence of symptoms that necessitated ruling out of the disease of interest, (3) symptomatic infection with the disease of interest occurring during the individual's period of active monitoring, (4) symptomatic infection with the disease of interest occurring outside the individual's period of active monitoring. Scenario 4 represents the highest risk of widespread transmission and reduces the chance of a positive clinical outcome for the sick individual. 

Our model calculates the probability of each of the four outcomes, with the associated expected costs, by combining the data on the probabilities of infection, the estimated incubation period distribution, and potential cost ranges for different outcomes. Additionally, it determines the uncertainty associated with these estimates due to not having precise incubation period observations and having an unknown time between exposure and the beginning of monitoring for a particular individual (see Supplement). We assume that infectiousness coincides with the onset of symptoms.[@Velasquez:2015gv;@Cowling:2015vb;@Fenner:1988ux]

![Figure 1. Model schematic representing four outcome scenarios for a person under active monitoring. Estimated costs shown are based on published costs[@Yacisin:2015wm] as well as new data from NYC DOHMH and Bellevue Hospital in NYC. Details on the model formulation are available in the Supplement.](static-figures/figure1-model-schema-v7.jpg)

Our model estimates the risks and costs associated with active monitoring programs for a range of active monitoring durations. Data on the number of individuals actively monitored by DOHMH and costs associated with the DOHMH Ebola response were used to estimate the cost per person-day of monitoring.  Additionally, for the purposes of hypothetical cost calculations, we assumed that an individual who became sick while under active monitoring gave rise to no secondary infections, while an individual who developed symptoms after her active monitoring period ended could give rise to as many as 4 new Ebola infections (an upper estimate of $R_0$ based on prior research [@Althaus:2014cw;@Chowell:2004gh]).

We developed open-source software, including a freely-available web application [[provide links]]. All analyses were run in `r R.version.string`.[@rcoreteam] These tools enable widespread dissemination of our results and facilitate calculations for emerging pathogens.

### Stratifying by exposure risk
Classifying individuals based on prior exposure risks enables targeted strategies in a range of public health response settings, including active monitoring. For example, in response to the west African Ebola outbreak, CDC issued recommendations on risk stratification of individuals for a potential Ebola exposure ("high risk", "some risk", "low (but not zero) risk", "no identifiable risk") and for how long and how intensively individuals in each of these categories should be monitored.[@CentersforDiseaseControlandPrevention:2015tc] DOHMH's active monitoring program, described previously[@Millman:2016cz], was implemented consistent with CDC recommendations.

For the CDC Ebola risk strata, we estimated probabilities of a monitored individual developing Ebola. These estimates were based on extrapolated numbers of actively monitored individuals in the United States during 2014-2016[@StehlingAriza:2015vd] and public data on the four domestic cases of Ebola[@CentersforDiseaseControlandPrevention:VbDBWqNH] (see Supplement for details).

# Results

### Incubation period estimates

Estimates and credible regions for incubation period distribution parameters for Ebola, MERS-CoV, and smallpox are shown in Figure 2. Consistent with other studies that used the same data,[@Faye:2015jc;@Virlogeux:2016ty;@Nishiura:2009dh] we estimate that half of all cases of Ebola will have incubation periods of less than `r my_round(mean(pstr_gamma_params_ebola$median),1)` days (95% CI: `r my_round(quantile(pstr_gamma_params_ebola$median, .025),1)`--`r my_round(quantile(pstr_gamma_params_ebola$median, .975),1)`), of MERS-CoV less than `r my_round(mean(pstr_gamma_params_mers$median),1)` days (95% CI: `r my_round(quantile(pstr_gamma_params_mers$median, .025),1)`--`r my_round(quantile(pstr_gamma_params_mers$median, .975),1)`) and of smallpox less than `r my_round(mean(pstr_gamma_params_smallpox$median),1)` days (95% CI: `r my_round(quantile(pstr_gamma_params_smallpox$median, .025),1)`--`r my_round(quantile(pstr_gamma_params_smallpox$median, .975),1)`). Additionally, the data suggest that 95% cases of Ebola will have incubation periods of less than `r my_round(mean(pstr_gamma_params_ebola$p95),1)` days (95% CI: `r my_round(quantile(pstr_gamma_params_ebola$p95, .025),1)`--`r my_round(quantile(pstr_gamma_params_ebola$p95, .975),1)`), of MERS-CoV `r my_round(mean(pstr_gamma_params_mers$p95),1)` days (95% CI: `r my_round(quantile(pstr_gamma_params_mers$p95, .025),1)`--`r my_round(quantile(pstr_gamma_params_mers$p95, .975),1)`), and of smallpox `r my_round(mean(pstr_gamma_params_smallpox$p95),1)` days (95% CI: `r my_round(quantile(pstr_gamma_params_smallpox$p95, .025),1)`--`r my_round(quantile(pstr_gamma_params_smallpox$p95, .975),1)`).

Smallpox is estimated to have the longest median incubation period of the three pathogens considered, although its distribution also showed the least overall variance. We estimate that MERS-CoV incubation periods are the shortest of the three, with the upper limit of the 95th percentile being just above 15 days (Figure 2). 


```{r figure2-estimated-distribution-dynamic, fig.path='static-figures/', fig.show='hide', fig.height=5, cache=TRUE}
data(kde_smallpox) 
data(kde_ebola)
data(kde_mers)
colors <- c("#1b9e77", "#d95f02", "#7570b3")
lighter_colors <- c("#8ecfbc", "#fdb174", "#b8b6d6")
plot_all_regions <- plot_modified_credible_regions(list(pstr_gamma_params_ebola,
                                                        pstr_gamma_params_mers,
                                                        pstr_gamma_params_smallpox), 
                                                   kdes=list(kde_ebola, 
                                                             kde_mers,
                                                             kde_smallpox),
                                                   label_txt=c("Ebola", "MERS-CoV", "Smallpox"),
                                                   colors=colors)
nplots <- 500
ebola_densities <- plot_gamma_densities(pstr_gamma_params_ebola, kde=kde_ebola,
                                        n_to_plot = nplots, 
                                        plotcolor=colors[1], 
                                        plotcolor_light = lighter_colors[1],
                                        label_txt="Ebola",
                                        xaxs_lab=FALSE)
mers_densities <- plot_gamma_densities(pstr_gamma_params_mers, kde=kde_mers,
                                       n_to_plot = nplots, 
                                       plotcolor=colors[2], 
                                       plotcolor_light = lighter_colors[2],
                                       label_txt="MERS-CoV",
                                       xaxs_lab=FALSE)
smallpox_densities <- plot_gamma_densities(pstr_gamma_params_smallpox, kde=kde_smallpox,
                                           n_to_plot = nplots, 
                                           plotcolor=colors[3], 
                                           plotcolor_light = lighter_colors[3],
                                           label_txt="Smallpox",
                                           xaxs_lab=TRUE)

grid.arrange(plot_all_regions,
             arrangeGrob(ebola_densities, mers_densities, smallpox_densities,
                         heights=c(.32, .32, .36)),
             ncol=2)
```

![Figure 2. Estimates and credible regions for incubation period distributions for Ebola, MERS-CoV and smallpox. The shaded elliptical areas represent regions that contain 95% of the estimated posterior distributions for each of the three diseases. The disease-specific curves plotted on the right show the estimated distribution for the incubation period for each disease (dark line). To show some of the uncertainty associated with these estimates, a random selection of density functions sampled from the joint posterior are represented by colored transparent lines around the heavy lines. Shaded vertical bands indicate the marginal credible regions for the median and 95th percentile.](static-figures/figure2-estimated-distribution-dynamic-5.png)


### Modeling the risk of symptomatic illness: Ebola case study

Using information on cases of Ebola diagnosed in the US, as well as extrapolated case information, we estimated the probability of a "some-risk" or "high-risk" individual developing a symptomatic infection with Ebola as 1 in 1,000. For "low (but not zero) risk" individuals, we estimated this risk to be 1 in 10,000. (See Supplement for details.)

<!--### Summarize risk estimates across durations of active monitoring for CDC exposure groups -->
Incorporating these probabilities into our model, we calculated for each pathogen the probabilities of symptomatic illness developing in an individual after they were no longer being actively monitored. To standardize the results across diseases, we present the risk estimates across a range of different active monitoring period durations, shown as multiples of the median incubation period for each disease (Figure 3). 

The model showed that an increase in the duration of the active monitoring period is associated with a decline in the probability that an individual develops symptoms due to the disease of concern after the active monitoring period ends. The rate at which that risk declines depends on the estimated variability of the incubation period distribution. Since the estimated incubation period distribution for Ebola showed the highest variability, the probability of symptoms occurring after active monitoring ends decreased more slowly when compared with the other pathogens. 

During the west African Ebola outbreak, CDC recommended active monitoring for 21 days. This corresponds to about `r my_round(21/mean(pstr_gamma_params_ebola$median),1)` times the estimated median incubation period for Ebola  of `r my_round(mean(pstr_gamma_params_ebola$median),1)` days (vertical dashed line, Figure 3). To tolerate the same level of absolute risk for either MERS-CoV or Smallpox, our model suggests that a duration of active monitoring could be set at less than 2 times the median incubation period. 

```{r risk-plots, fig.show='hide', cache=TRUE}
phis <- c(1/1000, 1/10000)
durs <- 5:40
yrange <- c(1e-18, 1e-2)

## determine max u for each disease such that max(u)/2 + m = 90th percentile of T
tmp <- mean(qgamma(.90, shape=pstr_gamma_params_ebola$shape, scale=pstr_gamma_params_ebola$scale))
maxu_ebola <- 2*(tmp - mean(pstr_gamma_params_ebola$median))

tmp <- mean(qgamma(.90, shape=pstr_gamma_params_mers$shape, scale=pstr_gamma_params_mers$scale))
maxu_mers <- 2*(tmp - mean(pstr_gamma_params_mers$median))

tmp <- mean(qgamma(.90, shape=pstr_gamma_params_smallpox$shape, scale=pstr_gamma_params_smallpox$scale))
maxu_smallpox <- 2*(tmp - mean(pstr_gamma_params_smallpox$median))

## make plots/data
p_ebola <- plot_risk_uncertainty(pstr_gamma_params_ebola, phi=phis, 
                                 max_u = maxu_ebola,
                                 durations=durs, 
                                 return_plot=TRUE,
                                 return_data=TRUE,
                                 yrange=yrange, include_xlab = FALSE,
                                 include_legend = FALSE)
p_ebola_text <- arrangeGrob(p_ebola[["plot"]], 
                               left=textGrob("Ebola",gp=gpar(fontface="bold"), rot=90, vjust=1))
p_mers <- plot_risk_uncertainty(pstr_gamma_params_mers, phi=phis, 
                                max_u = maxu_mers,
                                durations=durs, return_plot=TRUE,
                                return_data=TRUE,
                                include_xlab = FALSE, yrange=yrange, 
                                include_legend=FALSE)
p_mers_text <- arrangeGrob(p_mers[["plot"]], 
                           left=textGrob("MERS-CoV",gp=gpar(fontface="bold"), rot=90, vjust=1))
p_smallpox <- plot_risk_uncertainty(pstr_gamma_params_smallpox, phi=phis, 
                                    max_u = maxu_smallpox,
                                    durations=durs, return_plot=TRUE,
                                    return_data=TRUE,
                                    include_legend=FALSE, yrange=yrange)
p_smallpox_text <- arrangeGrob(p_smallpox[["plot"]], 
                               left=textGrob("Smallpox",gp=gpar(fontface="bold"), rot=90, vjust=1))
```

```{r, fig.cap="Figure 3. Estimated probabilities of symptoms occuring after active monitoring (AM) ends across different active monitoring period durations, shown as multiples of the median incubation period. Figures are shown for some- or high-risk ($\\phi$=1/1,000) and low (but not zero) risk ($\\phi$=1/10,000) scenarios. The vertical dashed line indicates the 21 day duration recommended for Ebola active monitoring (i.e. approximately 2.4 times the median incubation period of Ebola).", fig.height=3}

data_for_scaling <- data_frame(Disease=c("Ebola", "MERS-CoV", "Smallpox"),
                               median_incper=c(mean(pstr_gamma_params_ebola$median),
                                               mean(pstr_gamma_params_mers$median), 
                                               mean(pstr_gamma_params_smallpox$median)))

all_data <- rbind(mutate(p_ebola[["data"]], Disease="Ebola"),
                  mutate(p_mers[["data"]], Disease="MERS-CoV"),
                  mutate(p_smallpox[["data"]], Disease="Smallpox")) %>%
    mutate(Disease=factor(Disease)) %>%
    left_join(data_for_scaling) %>%
    mutate(d_scaled = d/median_incper,
           phi_lab = factor(phi, 
                            levels=c(1/1000, 1/10000),
                            labels=c("some or high risk", "low (but not zero) risk")))
                            ##labels=c("phi==1/100", "phi==1/1000", "phi==1/10000")))

colors <- c("#1b9e77", "#d95f02", "#7570b3")
ggplot(all_data, aes(x=d_scaled, y=p50)) + 
    geom_smooth(aes(color=Disease), se=FALSE) + 
    #geom_ribbon(aes(ymin=p05, ymax=p95, fill=Disease), alpha=.1) +
    facet_grid(.~phi_lab) + #, labeller=label_parsed) + 
    scale_y_log10(breaks=c(1/10000, 1/100000, 1/1000000, 1/10000000, 1/100000000), labels=c("1/10,000", "1/100,000", "1/1,000,000", "1/10,000,000","1/100,000,000")) +
    scale_color_manual(values=colors) +
    geom_vline(xintercept=21/mean(pstr_gamma_params_ebola$median),
               linetype=2, color=colors[1]) +
    coord_cartesian(ylim=c(1e-9, 5e-04), xlim=c(1, 3)) +
    xlab("Duration of AM period (in multiples of median incubation period)") +
    ylab("Probability of symptoms after AM")
```




### Estimated costs of active monitoring programs: Ebola case study
<!--### Provide esimated cost per individual of monitoring in NYC-->
The total expense for Ebola response by DOHMH during the period from July 31, 2014–November 7, 2015 was $9.7 million. Of this, $4.3 million was in response to a single Ebola case [@Yacisin:2015wm] and $1.9 million was for active monitoring. The remaining balance of $3.5 million was used for other Ebola preparedness activities. DOHMH monitored 5,321 individuals during this period (active monitoring began in NYC on October 25, 2014). These data imply that the cost of monitoring per person-day in NYC was $10–$20.

Of the 5,321 monitored individuals, around 30 (0.6%) developed symptoms within the 21 day monitoring period that were serious enough to necessitate hospitalization to rule-out Ebola. None of the monitored individuals developed Ebola. (The single Ebola case diagnosed in NYC occurred prior to active monitoring being implemented.) It cost between $10,000 and $30,000 per hospitalization to rule out Ebola infection in symptomatic, actively monitored individuals at Bellevue Hospital in NYC (John Maher, personal communication). This does not include the substantial infrastructural costs of creating and maintaining a special pathogens unit. 

<!-- ### Compare costs of different categories -->


```{r primary-cost-analysis, results='asis'}
## $1.9m, 5449 monitored, 21 day duration
per_day_cost <- 1900000/(5449*21)

## calculate per-day hazard of symptoms with other pathogens
n_monitored <- 5321
n_symptomatic <- 103
s.21 <- 1-n_symptomatic*.3/n_monitored
per_day_hazard <- 1-s.21^(1/21)

cost_m <- c(10, 20)     ## per day cost of treatment
cost_trt <- c(3e6, 5e6) ## cost of response to single case
cost_exp <- c(0, 20e6)  ## cost of response to single case not captured by monitoring
cost_falsepos <- c(10000,30000) ## cost of false positive testing

cost_mat <- rbind(cost_m, cost_trt, cost_exp, cost_falsepos)

gamma_params <- c(median = mean(pstr_gamma_params_ebola$median), 
                shape = mean(pstr_gamma_params_ebola$shape),
                scale = mean(pstr_gamma_params_ebola$scale))
durs <- c(1.5, 2, 3, 5)
phis <- c(1/1000, 1/10000)

costs <- calc_monitoring_costs(durs = durs,
                               probs_of_disease = phis,
                               per_day_hazard = per_day_hazard,
                               N = 100,
                               cost_mat = cost_mat,
                               gamma_params = gamma_params)

nphi <- length(phis)
ndurs <- length(durs)
out <- matrix(NA, nrow=nphi, ncol=ndurs)
colnames(out) <- durs
rownames(out) <- phis
k <- 0
for(i in 1:length(phis)) {
    for(j in 1:length(durs)) {
        k <- k+1
        num_costs <- as.numeric(costs[k,c("mincost", "maxcost")])
        out[i,j] <- paste0("$", formatC(round(num_costs[1], -3)/1000, big.mark=",", format="d"), 
                           "-$", formatC(round(num_costs[2], -3)/1000, big.mark=",", format="d"))
    }
}

rownames(out) <- c("some risk and high risk", "low (but not zero) risk") 
kable(out, 
      caption="Table 1: Total expected costs to the public health system (including active monitoring and response) per 100 monitored individuals, at two exposure risk levels. Columns represent multiples of the median incubation period of Ebola. Rows represent the CDC risk stratification. Costs are inclusive of active monitoring and public health response and are based on model outputs for Ebola. Values are in $'000s.")

# ggplot(num_out, aes(x=dur, color=factor(phi), fill=factor(phi))) + 
#     geom_ribbon(aes(ymin=mincost, ymax=maxcost), alpha=.5) + geom_hline(yintercept=1900000)
```


```{r optimized-cost-analysis, fig.path='static-figures/', fig.show='hide'}
durs <- seq(.5, 5, by=.1)
phis <- c(1/1000, 1/10000)

costs <- calc_monitoring_costs(durs = durs,
                               probs_of_disease = phis,
                               per_day_hazard = per_day_hazard,
                               N = 100,
                               cost_mat = cost_mat,
                               gamma_params = gamma_params, 
                               return_scalar=FALSE)

costs$phi_lab <- factor(costs$phi, 
                        levels=c(1/1000, 1/10000),
                        labels=c("some or high risk", "low (but not zero) risk"))

## minimum costs 
min_costs <- costs %>%
    group_by(phi) %>%
    summarize(min_cost = min(maxcost),
              min_cost_dur = dur[which.min(maxcost)],
              min_cost_dur_days = min_cost_dur * gamma_params['median']) %>%
    as.matrix()

ggplot(costs, aes(x=dur*gamma_params['median'], 
                  color=phi_lab, fill=phi_lab)) + 
    geom_ribbon(aes(ymin=mincost, ymax=maxcost), alpha=.7) + 
    scale_y_continuous(breaks=c(1e5, 5e5, 10e5, 15e5, 20e5), labels=dollar,
                       name='Cost range of monitoring 100 individuals') +
    scale_x_continuous(name='Duration (in days)') +
    coord_cartesian(xlim=c(5, 43)) +
    scale_fill_manual(values=c("#e41a1c", "#377eb8")) +
    scale_color_manual(values=c("#e41a1c", "#377eb8")) +
    geom_segment(aes(x=3, xend=min_costs[1, "min_cost_dur_days"], 
                     y=min_costs[1, "min_cost"], yend=min_costs[1, "min_cost"]), 
                 linetype=2, color="#377eb8") +
    geom_segment(aes(x=min_costs[1, "min_cost_dur_days"], xend=min_costs[1, "min_cost_dur_days"], 
                     y=0, yend=min_costs[1, "min_cost"]), 
                 linetype=2, color="#377eb8") +
    geom_segment(aes(x=3, xend=min_costs[2, "min_cost_dur_days"], 
                     y=min_costs[2, "min_cost"], yend=min_costs[2, "min_cost"]), 
                 linetype=2, color="#e41a1c") +
    geom_segment(aes(x=min_costs[2, "min_cost_dur_days"], xend=min_costs[2, "min_cost_dur_days"], 
                     y=0, yend=min_costs[2, "min_cost"]), 
                 linetype=2, color="#e41a1c") +
    theme(legend.title=element_blank(), legend.position=c(.8, .8))
    #geom_vline(xintercept=as.numeric(min_costs[1, "min_cost_dur_days"]), linetype=2, color="#377eb8") +
    #geom_vline(xintercept=as.numeric(min_costs[2, "min_cost_dur_days"]), linetype=2, color="#e41a1c") +
    ## geom_hline(yintercept=1900000) + 
    ## geom_hline(yintercept=opt_10K$objective, linetype=2) +
    ## geom_hline(yintercept=opt_1K$objective, linetype=2) +
    ## ggtitle("Estimated cost ranges of monitoring 100 individuals at two risk levels")
```


Our model provides estimates of risks and costs for active monitoring systems. We applied the model to the case-study of Ebola in NYC, based on data from DOHMH (Table 1, Figure 4). These figures reflect the fact that as the active monitoring period duration increases, the probability of the highest-cost events (an individual developing the disease of concern after active monitoring ends) decreases. However, at the same time, the cost of active monitoring and possible testing due to non-specific symptoms increases as more person-days are included in the active monitoring period. For the low-risk individuals, the model suggests that the cost is minimized with around 
`r round(min_costs[which(min_costs[,"phi"]==1e-4), "min_cost_dur_days"])` 
days (i.e.
`r round(min_costs[which(min_costs[,"phi"]==1e-4), "min_cost_dur_days"]/mean(pstr_gamma_params_ebola$median),1)` 
median incubation periods)
of monitoring. For the high-risk individuals, the model suggests that the cost is minimized with around
`r round(min_costs[which(min_costs[,"phi"]==1e-3), "min_cost_dur_days"])` 
days 
(i.e.
`r round(min_costs[which(min_costs[,"phi"]==1e-3), "min_cost_dur_days"]/mean(pstr_gamma_params_ebola$median),1)` 
median incubation periods)
of monitoring (Figure 4). 


![Figure 4. Estimated cost ranges for actively monitoring 100 individuals, calculated separately for some or high risk individuals and low (but not zero) risk individuals.](static-figures/optimized-cost-analysis-1.png)

# Discussion

For three pathogens of significant public health concern, we quantified the risk, costs, and attendant uncertainty associated with specific durations of active monitoring. The approach presented can be used to develop empirically based public health policies in future outbreaks.

Perception of risk is a key component of decision making, but ultimately science should inform public health policies. A key challenge faced by decision makers is that the public's perception of risk is often determined by the consequences even if the event itself is rare. With severe diseases, the consequences may be perceived as so dire that the public's tolerance for risk will be low, essentially demanding a guaranteed zero probability of an event occurring. While no policy can guarantee zero risk, analyses such as those presented here can assist in determining appropriate thresholds which reduce risk below a tolerable level, even for a risk-averse population.

Quarantine policies in countries at low risk for an Ebola outbreak raised many ethical issues during the west African Ebola outbreak.[@Drazen:2014iz] CDC’s Ebola active monitoring recommendations were a critical component of the public health response in the United States that strived to balance the concerns from a diverse set of stakeholders without unnecessarily restricting individual liberties.[@CentersforDiseaseControlandPrevention:lyxYF_Hp] 
For diseases in which the onset of infectiousness precedes the onset of symptoms, detection of the cases based on active monitoring of symptomology might not be soon enough to prevent secondary transmission.  As such, for these diseases, quarantine might be the most appropriate public health measure.

Evaluating the cost of monitoring programs is a challenging, multi-faceted problem. While we present new data from the DOHMH active monitoring program showing that the per-individual cost of monitoring is "low" (about $10–$20 per day), the total program cost can be substantial. Therefore minimizing unnecessary monitoring could provide valuable savings. 

Some cost-efficiency may be achieved through simple targeted strategies. As CDC recommended for Ebola, it may be appropriate to use exposure risk categories to modify the duration or intensity of active monitoring. Additionally, stronger public health messaging could encourage travelers to take necessary health precautions to avoid common travel-associated illnesses, e.g. malaria. This in turn could reduce unnecessary testing and costs associated with symptomatic events with diseases other than the one of concern. Low-cost versions of active monitoring have the potential to add value to public health response to less severe outbreaks as well.
 
Our model can suggest durations of active monitoring for emerging pathogens early in an outbreak. Accurate estimates of the median incubation period can be made even when few data are available.[@Reich:2009jq] While accurately estimating the variability of the incubation period requires more data, existing data on the variation observed in similar pathogens could be used to inform early estimates until better data becomes available. 

While we have used some of the best available data on large-scale active monitoring programs in our analyses, additional data could improve the estimates provided by this work. Specifically, data on the last possible exposure before the beginning of active monitoring could be used to more explicitly pinpoint an individual's risk of developing the disease of concern. Additionally, to obtain good estimates of the extreme quantiles of the incubation period distribution, the World Health Organization recommends using over 200 observations of precisely observed data.[@WorldHealthOrganization:QuWKXo2f] When estimating incubation periods in real-time, care must be taken to adjust for possible truncation of longer incubation periods [@Brookmeyer:2001gx;@Nishiura:2011dc] or selection biases that could favor reporting of shorter incubation periods [@Virlogeux:2016ty]. 
 
To the best of our knowledge, we report the first estimate of the cost of active monitoring per individual. Our calculations may be easily adapted for other scenarios. Some potential costs and savings were not factored in to these calculations. The estimates available from DOHMH do not include the costs of cell phones given to monitored individuals, the CDC staff time in managing and monitoring screening data and running airport screenings, the US Department of Homeland Security staff time at airport screening, and the costs of tests for individuals with symptoms that were not due to Ebola. More detailed cost data was not available from DOHMH, but such data could help to disentangle the fixed costs associated with running an active monitoring program from the cost per monitored individual. Additionally, local considerations prompted DOHMH to opt for an active monitoring program involving humans to make and receive active monitoring reports from individuals. In contrast, other jurisdictions used digital systems to administer monitoring reports. The merits of these different approaches deserve further investigation.

Active monitoring is a useful tool for minimizing risk in critical, real-time outbreak response. Our framework for evaluating the risks and costs associated with active monitoring of infectious diseases provides valuable information needed to assess the cost-effectiveness of active monitoring policies. These tools could be used to help guide future assessments and data collection on active monitoring programs. They also provide a pathway for data to inform the design of active monitoring programs for the next global disease threat.

# Acknowledgments
We thank the persons who underwent active monitoring in NYC and the DOHMH staff involved in active monitoring. We thank Dr. Simon Cauchemez and Dr. Amadou Sall for providing access to the Ebola incubation period data from Guinea and giving perimssion for this data to be made publicly available. We also acknowledge Mr. John Maher for providing details on costs of evaluating Ebola patients at Bellvue Hospital in New York City.

# Bibliography
