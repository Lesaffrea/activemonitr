---
title: "Quantifying the Risk and Cost of Active Monitoring for Infectious Diseases"
author: "Nicholas G Reich*, Justin Lessler, Jay K Varma, Neil M Vora"
date: "September 2017"
output:
  word_document:
    fig_caption: yes
    fig_height: 5
    fig_width: 5
    md_extensions: +implicit_figures
    reference_docx: aje-word-style.docx
  pdf_document:
    fig_caption: yes
    fig_height: 5
    fig_width: 5
    keep_tex: yes
    md_extensions: +implicit_figures
header-includes: \usepackage{setspace}\doublespacing
csl: emerging-infectious-diseases.csl
bibliography: active-monitoring.bib
---

```{r global-options, include=FALSE}
knitr::opts_chunk$set(fig.width=7.5, fig.height=5, fig.path='figs/',
    echo=FALSE, warning=FALSE, message=FALSE,
    dev="pdf")

my_round <- function(x, k) format(round(x, k), nsmall=k)
```

```{r load-results}
library(activeMonitr)
library(gridExtra)
library(ggplot2)
library(broom)
library(scales)
library(knitr)
theme_set(theme_bw())
data("pstr_gamma_params_ebola")
data("pstr_gamma_params_mers")
data("pstr_gamma_params_smallpox")
source('../analysis-code/inc-per-mcmc.R')
```

\ 


<!--\begingroup \small

\vspace{10em} -->


__Author Affiliations:__
University of Massachusetts, Amherst, Massachusetts, USA (N.G. Reich);
Johns Hopkins Bloomberg School of Public Health, Baltimore, Maryland, USA (J. Lessler);
New York City Department of Health and Mental Hygiene, USA (J.K. Varma, N.M. Vora);
Centers for Disease Control and Prevention, Atlanta, Georgia, USA (J.K. Varma, N.M. Vora)

\ 

<!-- \endgroup-->

<!--\clearpage-->




During outbreaks of deadly emerging pathogens (e.g., Ebola, MERS-CoV) and bioterror threats (e.g., smallpox), actively monitoring potentially infected individuals aims to limit disease transmission and morbidity. 
Guidance issued by CDC on active monitoring was a cornerstone of its response to the West Africa Ebola outbreak. 
There are limited data on how to balance the costs and performance of this important public health activity.
We present a framework that estimates the risks and costs of specific durations of active monitoring for pathogens of significant public health concern. 
We analyze data from New York City's Ebola active monitoring program over a 16-month period in 2014-2016.
For monitored individuals, we identified unique durations of active monitoring that minimize expected costs for those at "low (but not zero) risk" and "some or high risk": 21 and 31 days, respectively. 
Extending our analysis to smallpox and MERS-CoV, we found that the optimal length of active monitoring relative to the median incubation period was reduced compared to Ebola due to less variable incubation periods. 
Active monitoring can save lives but is expensive. 
Resources can be most effectively allocated by using exposure-risk categories to modify the duration or intensity of active monitoring. 
<!-- \clearpage-->

# Introduction

The outbreak of Ebola virus disease (Ebola) in west Africa was the largest outbreak of a highly virulent acute infection in modern times, leading the global health community to reassess the ability of highly pathogenic acute infections to spread widely in today’s interconnected world. To improve rapid identification and evaluation of individuals infected with Ebola, on October 27, 2014, the U.S. Centers for Disease Control and Prevention (CDC) recommended active monitoring of individuals potentially exposed to Ebola virus. Individuals under active monitoring were asked to contact local health authorities to report their health status every day for 21 days after their last potential exposure. 

Thousands of individuals were monitored for Ebola in the United States between October 2014 and February 2016, including over 10,000 individuals during one five month period.[@StehlingAriza:2015vd] 
CDC’s guidance on active monitoring was a cornerstone of its response to Ebola. The guidance balanced numerous stakeholder concerns, including mitigating risk to communities and travelers without unnecessarily restricting individual liberties.
Recommendations for active monitoring were discontinued in February 2016.[@CentersforDiseaseControlandPrevention:lyxYF_Hp] 
Over 20% of all individuals actively monitored for Ebola in the United States were monitored in New York City (NYC), more than any other jurisdiction.[@StehlingAriza:2015vd]

Active monitoring may help prevent and contain outbreaks of rapidly spreading emerging pathogens that pose a grave threat to public health. Such outbreaks may occur naturally, via a bioterrorist attack, or via unintended release from a laboratory. The decision to implement active monitoring, or another non-pharmaceutical intervention, depends on an assessment of the risk posed by a pathogen and the ability of the chosen intervention to reduce that risk.[@peak2017comparing] Key considerations include the transmissibility and pathogenicity of the pathogen, the potential size of an outbreak, and the relationship between the time of symptom onset and infectiousness.[@Fraser:2004ci] Ebola, Middle East Respiratory Syndrome Coronavirus (MERS-CoV), and smallpox are examples of viral illnesses for which active monitoring could play a pivotal role in preventing a large-scale outbreak.[@CentersforDiseaseControlandPrevention:2015tk]

Active monitoring programs must balance conflicting priorities. The central goals of these programs are to identify, isolate, and treat infected individuals quickly. Setting an active monitoring period many times longer than any known incubation period of the pathogen of interest could virtually guarantee that all infected individuals would exhibit symptoms while being monitored. However, such a program would be unreasonably expensive, inconvenience monitored individuals, and incur many financial and social costs through frequent responses to false positive cases. Evidence-based monitoring periods and appropriate tailoring of the monitoring intensity to disease risk should therefore be used to balance costs with biosecurity risks. 

Here we present an empirical framework for evaluating the risks and costs associated with active monitoring (implemented in an online tool available at http://iddynamics.jhsph.edu/apps/shiny/activemonitr/). We apply this framework to Ebola, MERS-CoV, and smallpox using data on the natural history of these diseases and data from the Ebola response of the NYC Department of Health and Mental Hygiene (DOHMH). 


# Methods

### Estimating the incubation period distribution
The incubation period of a disease is the duration of time between exposure to the pathogen and symptom onset.[@Brookmeyer:2005bc] This characteristic is imperfectly observed in most settings.[@Reich:2009jq;@Lessler:2009ub] We obtained previously published incubation period observations on 145 cases of Ebola in Guinea [@Faye:2015jc], 170 laboratory-confirmed cases of MERS-CoV in South Korea[@Virlogeux:2016ty] and 362 cases of smallpox[@Litvinjenko:1972vp;@Mack:1972jc;@Nishiura:2009dh]. We fit parametric distributions to the observed incubation period data using maximum likelihood techniques (see Supplemental Text). We ran sensitivity analyses to evaluate the influence of several outlying observations in the Ebola dataset. 
 
### A model for active monitoring outcomes
We developed a probabilistic model that uses varying probabilities to alter the incubation period, thus estimating whether active monitoring would identify an individual infected with the pathogen of interest. Figure 1 presents the model schema, which involves a monitored individual having one of four outcomes: 

1. no symptoms warranting clinical follow-up, 
2. no symptomatic infection with the disease of interest, but occurrence of symptoms that necessitate ruling out of the disease of interest, 
3. symptomatic infection with the disease of interest occurring during the individual's period of active monitoring, and
4. symptomatic infection with the disease of interest occurring outside the individual's period of active monitoring. 

Scenario 4 represents the highest risk of secondary transmission and may also reduce the chance of a positive clinical outcome for the sick individual. 

We use a population-level probabilistic model with five key parameters. For a given set of parameters, the model calculates the expected number of individuals in a particular population or cohort of a fixed size that experience each of the four outcomes listed above. Each outcome has a specific cost and model-based probability associated with it (see Supplement and Figure 1 for details). These calculations are repeated for a set of stochastic samples of possible parameter values (e.g. samples from the posterior distribution of incubation period parameters) to provide measures of uncertainty.

Since limited data prevent us from formally estimating variance, we created conservative (i.e. maximally wide) intervals for possible costs by using the endpoints of the plausible cost ranges.
Additionally, it determines the uncertainty associated with these estimates due to not having precise incubation period observations and having an unknown time between exposure and the beginning of monitoring for a particular individual (see Supplemental Text). For these pathogens, we assume that infectiousness coincides with the onset of symptoms.[@Velasquez:2015gv;@Cowling:2015vb;@Fenner:1988ux]

Our model estimates the risks and costs associated with active monitoring programs for a range of active monitoring durations. To estimate the cost per person-day of monitoring, we used data on the number of individuals actively monitored by DOHMH and costs associated with the DOHMH Ebola response.  Additionally, for the purposes of hypothetical cost calculations, we assumed that an individual who becomes symptomatic with the disease of interest while under active monitoring gives rise to no secondary infections, while an individual who develops symptoms after his/her active monitoring period ends could give rise to as many as 4 new Ebola infections (an upper estimate based on prior research [@Althaus:2014cw;@Chowell:2004gh]).

### Stratifying by exposure risk
Classifying individuals based on prior exposure risks enables targeted strategies in a range of public health response settings, including active monitoring. For example, in response to the West Africa Ebola outbreak, CDC issued recommendations on risk stratification of individuals for a potential Ebola virus exposure ("high risk", "some risk", "low (but not zero) risk", "no identifiable risk") and for how long and how intensively individuals in each of these categories should be monitored.[@CentersforDiseaseControlandPrevention:2015tc] DOHMH's active monitoring program, described previously[@Millman:2016cz], was implemented consistent with CDC recommendations. However, creating, evaluating, and modifying such classifications in practice is a difficult task and requires situational awareness and data that would vary depending on the pathogen and outbreak setting.

For the CDC Ebola risk strata, we estimated probabilities of a monitored individual developing Ebola. These estimates were based on extrapolated numbers of actively monitored individuals in the United States during 2014-2016[@StehlingAriza:2015vd] and public data on the four domestic cases of Ebola[@CentersforDiseaseControlandPrevention:VbDBWqNH] (Supplemental Text, Table 2).

### Data Availability

We developed open-source software, including a freely-available web application at [http://iddynamics.jhsph.edu/apps/shiny/activemonitr/](http://iddynamics.jhsph.edu/apps/shiny/activemonitr/). The source code for the web app, the data for the analyses, and the code to reproduce this manuscript itself are all freely available online under an open-source license at GitHub (https://github.com/reichlab/activemonitr), with a static version in an open-access digital library [@Reich:2017z]. All analyses were run in `r R.version.string`.[@rcoreteam] These tools enable others to easily implement our model and reproduce our results.


# Results

### Incubation period estimates

Estimates and credible regions for incubation period distribution parameters for Ebola, MERS-CoV, and smallpox are shown in Figure 2. Consistent with other studies that used the same data,[@Faye:2015jc;@Virlogeux:2016ty;@Nishiura:2009dh] we estimated that half of all cases of Ebola will have an incubation period of less than `r my_round(mean(pstr_gamma_params_ebola$median),1)` days (95% CI: `r my_round(quantile(pstr_gamma_params_ebola$median, .025),1)`-`r my_round(quantile(pstr_gamma_params_ebola$median, .975),1)`), of MERS-CoV less than `r my_round(mean(pstr_gamma_params_mers$median),1)` days (95% CI: `r my_round(quantile(pstr_gamma_params_mers$median, .025),1)`-`r my_round(quantile(pstr_gamma_params_mers$median, .975),1)`) and of smallpox less than `r my_round(mean(pstr_gamma_params_smallpox$median),1)` days (95% CI: `r my_round(quantile(pstr_gamma_params_smallpox$median, .025),1)`-`r my_round(quantile(pstr_gamma_params_smallpox$median, .975),1)`). Additionally, the data suggest that 95% of cases of Ebola will have an incubation period of less than `r my_round(mean(pstr_gamma_params_ebola$p95),1)` days (95% CI: `r my_round(quantile(pstr_gamma_params_ebola$p95, .025),1)`-`r my_round(quantile(pstr_gamma_params_ebola$p95, .975),1)`), of MERS-CoV `r my_round(mean(pstr_gamma_params_mers$p95),1)` days (95% CI: `r my_round(quantile(pstr_gamma_params_mers$p95, .025),1)`-`r my_round(quantile(pstr_gamma_params_mers$p95, .975),1)`), and of smallpox `r my_round(mean(pstr_gamma_params_smallpox$p95),1)` days (95% CI: `r my_round(quantile(pstr_gamma_params_smallpox$p95, .025),1)`-`r my_round(quantile(pstr_gamma_params_smallpox$p95, .975),1)`).

We estimated smallpox to have the longest median incubation period of the three pathogens considered, although its distribution also showed the least overall variance. We estimate that MERS-CoV incubation periods are the shortest of the three, with the upper limit of the 95th percentile being just above 15 days (Figure 2). 


```{r figure2-estimated-distribution-dynamic, fig.path='static-figures/', fig.show='hide', fig.height=5, cache=FALSE, eval=TRUE}
data(kde_smallpox) 
data(kde_ebola)
data(kde_mers)
colors <- c("#1b9e77", "#d95f02", "#7570b3")
lighter_colors <- c("#8ecfbc", "#fdb174", "#b8b6d6")
plot_all_regions <- plot_modified_credible_regions(list(pstr_gamma_params_ebola,
                                                        pstr_gamma_params_mers,
                                                        pstr_gamma_params_smallpox), 
                                                   kdes=list(kde_ebola, 
                                                             kde_mers,
                                                             kde_smallpox),
                                                   label_txt=c("Ebola", "MERS-CoV", "Smallpox"),
                                                   colors=colors)
nplots <- 500
ebola_densities <- plot_gamma_densities(pstr_gamma_params_ebola, kde=kde_ebola,
                                        n_to_plot = nplots, 
                                        plotcolor=colors[1], 
                                        plotcolor_light = lighter_colors[1],
                                        label_txt="Ebola",
                                        xaxs_lab=FALSE)
mers_densities <- plot_gamma_densities(pstr_gamma_params_mers, kde=kde_mers,
                                       n_to_plot = nplots, 
                                       plotcolor=colors[2], 
                                       plotcolor_light = lighter_colors[2],
                                       label_txt="MERS-CoV",
                                       xaxs_lab=FALSE)
smallpox_densities <- plot_gamma_densities(pstr_gamma_params_smallpox, kde=kde_smallpox,
                                           n_to_plot = nplots, 
                                           plotcolor=colors[3], 
                                           plotcolor_light = lighter_colors[3],
                                           label_txt="Smallpox",
                                           xaxs_lab=TRUE)

grid.arrange(plot_all_regions,
             arrangeGrob(ebola_densities, mers_densities, smallpox_densities,
                         heights=c(.32, .32, .36)),
             ncol=2)
```

### Modeling the risk of symptomatic illness

Using information on cases of Ebola diagnosed in the U.S., as well as extrapolated case information, we estimated the probability of a "some-risk" or "high-risk" individual developing a symptomatic infection with Ebola as 1 in 1,000. For "low (but not zero) risk" individuals, we estimated this risk to be 1 in 10,000 (Supplemental Text, Table 2).

<!--### Summarize risk estimates across durations of active monitoring for CDC exposure groups -->
Incorporating these probabilities into our model, for each pathogen we calculated the probability of symptomatic illness developing in an individual after they were no longer being actively monitored. To standardize the results across diseases, we present the risk estimates across a range of different active monitoring period durations, shown as multiples of the median incubation period for each disease (Figure 3). 

The model showed that an increase in the duration of the active monitoring period is associated with a decline in the probability that an individual develops symptoms due to the disease of interest after the active monitoring period ends. The rate at which that risk declines depends on the estimated variability of the incubation period distribution. Since the estimated incubation period distribution for Ebola showed the highest variability, the probability of symptoms occurring after active monitoring ends decreased more slowly when compared with the other pathogens. This feature also impacts the sensitivity of estimating the optimal duration of active monitoring when the probabilities of developing symptomatic infection are mis-specified (Supplemental Text, Table 4).

During the West Africa Ebola outbreak, CDC recommended active monitoring for 21 days. This corresponds to about `r my_round(21/mean(pstr_gamma_params_ebola$median),1)` times the median incubation period for Ebola (vertical dashed line, Figure 3). To achieve the same level of absolute risk for either MERS-CoV or smallpox, our model suggests that a duration of active monitoring would need to be set at less than two times the median incubation period for both of these diseases. 

```{r risk-plots, fig.show='hide', cache=FALSE}
phis <- c(1/1000, 1/10000)
durs <- 5:40
yrange <- c(1e-18, 1e-2)

## determine max u for each disease such that max(u)/2 + m = 90th percentile of T
tmp <- mean(qgamma(.90, shape=pstr_gamma_params_ebola$shape, scale=pstr_gamma_params_ebola$scale))
maxu_ebola <- 2*(tmp - mean(pstr_gamma_params_ebola$median))

tmp <- mean(qgamma(.90, shape=pstr_gamma_params_mers$shape, scale=pstr_gamma_params_mers$scale))
maxu_mers <- 2*(tmp - mean(pstr_gamma_params_mers$median))

tmp <- mean(qgamma(.90, shape=pstr_gamma_params_smallpox$shape, scale=pstr_gamma_params_smallpox$scale))
maxu_smallpox <- 2*(tmp - mean(pstr_gamma_params_smallpox$median))

## make plots/data
p_ebola <- plot_risk_uncertainty(pstr_gamma_params_ebola, phi=phis, 
                                 max_u = maxu_ebola,
                                 durations=durs, 
                                 return_plot=TRUE,
                                 return_data=TRUE,
                                 yrange=yrange, include_xlab = FALSE,
                                 include_legend = FALSE)
p_ebola_text <- arrangeGrob(p_ebola[["plot"]], 
                               left=textGrob("Ebola",gp=gpar(fontface="bold"), rot=90, vjust=1))
p_mers <- plot_risk_uncertainty(pstr_gamma_params_mers, phi=phis, 
                                max_u = maxu_mers,
                                durations=durs, return_plot=TRUE,
                                return_data=TRUE,
                                include_xlab = FALSE, yrange=yrange, 
                                include_legend=FALSE)
p_mers_text <- arrangeGrob(p_mers[["plot"]], 
                           left=textGrob("MERS-CoV",gp=gpar(fontface="bold"), rot=90, vjust=1))
p_smallpox <- plot_risk_uncertainty(pstr_gamma_params_smallpox, phi=phis, 
                                    max_u = maxu_smallpox,
                                    durations=durs, return_plot=TRUE,
                                    return_data=TRUE,
                                    include_legend=FALSE, yrange=yrange)
p_smallpox_text <- arrangeGrob(p_smallpox[["plot"]], 
                               left=textGrob("Smallpox",gp=gpar(fontface="bold"), rot=90, vjust=1))
```

```{r figure3-scaled-prob-symptoms, fig.path='static-figures/', fig.show='hide', fig.height=3}

data_for_scaling <- data_frame(Disease=c("Ebola", "MERS-CoV", "Smallpox"),
                               median_incper=c(mean(pstr_gamma_params_ebola$median),
                                               mean(pstr_gamma_params_mers$median), 
                                               mean(pstr_gamma_params_smallpox$median)))

## making long data_frame with data for each disease, including 
all_data <- rbind(mutate(p_ebola[["data"]], Disease="Ebola"),
                  mutate(p_mers[["data"]], Disease="MERS-CoV"),
                  mutate(p_smallpox[["data"]], Disease="Smallpox")) %>%
    mutate(Disease=factor(Disease)) %>%
    left_join(data_for_scaling) %>%
    mutate(d_scaled = d/median_incper,
           phi_lab = factor(phi, 
                            levels=c(1/1000, 1/10000),
                            labels=c("some or high risk", "low (but not zero) risk")))
                            ##labels=c("phi==1/100", "phi==1/1000", "phi==1/10000")))

colors <- c("#1b9e77", "#d95f02", "#7570b3")
ggplot(all_data, aes(x=d_scaled, y=p50)) + 
    geom_smooth(aes(color=Disease), se=FALSE) + 
    #geom_ribbon(aes(ymin=p05, ymax=p95, fill=Disease), alpha=.2) +
    facet_grid(.~phi_lab) + #, labeller=label_parsed) + 
    scale_y_log10(breaks=c(1/10000, 1/100000, 1/1000000, 1/10000000, 1/100000000), labels=c("1/10,000", "1/100,000", "1/1,000,000", "1/10,000,000","1/100,000,000")) +
    scale_color_manual(values=colors) +
    geom_vline(xintercept=21/mean(pstr_gamma_params_ebola$median),
               linetype=2, color=colors[1]) +
    coord_cartesian(ylim=c(1e-9, 5e-04), xlim=c(1, 3)) +
    xlab("Duration of AM period (in multiples of median incubation period)") +
    ylab("Probability of symptoms after AM")
```




### Minimizing costs of active monitoring programs: Ebola case study
<!--### Provide esimated cost per individual of monitoring in NYC-->
The total expense for Ebola response by DOHMH during the period from July 31, 2014–November 7, 2015 was $9.7 million. Of this, $4.3 million was in response to a single Ebola case [@Yacisin:2015wm] and $1.9 million was for active monitoring. The remaining balance of $3.5 million was used for other Ebola preparedness activities. DOHMH monitored 5,379 non-unique individuals during this period (active monitoring began in NYC on October 25, 2014). We used these data to estimate that the cost of monitoring per person-day in NYC was $10–$20.

The number of serious infection events occurring in actively monitored individuals in NYC was small. None of the monitored individuals developed Ebola. The single Ebola case diagnosed in NYC occurred before active monitoring was implemented. We assumed that a small fraction of monitored individuals, 30 (or 0.6%), developed symptoms within the 21 day monitoring period that were serious enough to necessitate hospitalization at an institution in NYC to rule-out Ebola. At one hospital, Bellevue, it cost between $10,000--$30,000 per hospitalization to rule out Ebola in symptomatic, actively monitored individuals (John Maher, NYC Health and Hospitals, personal communication). This does not include the substantial infrastructural costs of creating and maintaining a special pathogens unit at the hospital. 

<!-- ### Compare costs of different categories -->


```{r primary-cost-analysis, results='hide'}
## calculate per-day hazard of symptoms with other pathogens
n_monitored <- 5379   ## per email from Neil 6/20/2016
n_symptomatic <- 30   ## per email from Neil 6/20/2016, with conservative/high assumption
s.21 <- 1-n_symptomatic/n_monitored
per_day_hazard <- 1-s.21^(1/21)

## $1.9m, 5321 monitored, 21 day duration
per_day_cost <- 1900000/(n_monitored*21)

## cost matrix construction
## columns represent upper and lower bounds
cost_m <- c(10, 20)     ## per day cost of treatment
cost_trt <- c(3e6, 5e6) ## cost of response to single case
cost_exp <- c(0, 20e6)  ## cost of response to single case not captured by monitoring
cost_falsepos <- c(10000,30000) ## cost of false positive testing

cost_mat <- rbind(cost_m, cost_trt, cost_exp, cost_falsepos)

gamma_params <- c(median = mean(pstr_gamma_params_ebola$median), 
                shape = mean(pstr_gamma_params_ebola$shape),
                scale = mean(pstr_gamma_params_ebola$scale))
durs <- c(1.5, 2, 3, 5)
phis <- c(1/1000, 1/10000)

costs <- calc_monitoring_costs(durs = durs,
                               probs_of_disease = phis,
                               per_day_hazard = per_day_hazard,
                               N = 100,
                               cost_mat = cost_mat,
                               gamma_params = gamma_params)

## costs at 5th percentile duration...
gamma_params_p5 <- c(median = unname(quantile(pstr_gamma_params_ebola$median, prob=.05)), 
                     shape = unname(quantile(pstr_gamma_params_ebola$shape, prob=.05)),
                     scale = unname(quantile(pstr_gamma_params_ebola$scale, prob=.05)))
costs_p5 <- calc_monitoring_costs(durs = durs,
                                  probs_of_disease = phis,
                                  per_day_hazard = per_day_hazard,
                                  N = 100,
                                  cost_mat = cost_mat,
                                  gamma_params = gamma_params_p5)

## costs at 95th percentile duration...
gamma_params_p95 <- c(median = unname(quantile(pstr_gamma_params_ebola$median, prob=.95)), 
                      shape = unname(quantile(pstr_gamma_params_ebola$shape, prob=.95)),
                      scale = unname(quantile(pstr_gamma_params_ebola$scale, prob=.95)))
costs_p95 <- calc_monitoring_costs(durs = durs,
                                  probs_of_disease = phis,
                                  per_day_hazard = per_day_hazard,
                                  N = 100,
                                  cost_mat = cost_mat,
                                  gamma_params = gamma_params_p95)



nphi <- length(phis)
ndurs <- length(durs)
out <- matrix(NA, nrow=nphi, ncol=ndurs)
colnames(out) <- durs
rownames(out) <- phis
k <- 0
for(i in 1:length(phis)) {
    for(j in 1:length(durs)) {
        k <- k+1
        num_costs <- as.numeric(costs[k,c("mincost", "maxcost")])
        out[i,j] <- paste0("$", formatC(round(num_costs[1], -3)/1000, big.mark=",", format="d"), 
                           "-$", formatC(round(num_costs[2], -3)/1000, big.mark=",", format="d"))
    }
}

rownames(out) <- c("some risk and high risk", "low (but not zero) risk") 

#ggplot(num_out, aes(x=dur, color=factor(phi), fill=factor(phi))) + 
#  geom_ribbon(aes(ymin=mincost, ymax=maxcost), alpha=.5) +
#  geom_hline(yintercept=1900000)
```


```{r figure4-optimized-cost-analysis, fig.path='static-figures/', fig.show='hide'}
durs <- seq(.5, 5, by=.1)
phis <- c(1/1000, 1/10000)

costs <- calc_monitoring_costs(durs = durs,
                               probs_of_disease = phis,
                               per_day_hazard = per_day_hazard,
                               N = 100,
                               cost_mat = cost_mat,
                               gamma_params = gamma_params, 
                               return_scalar=FALSE)

costs$phi_lab <- factor(costs$phi, 
                        levels=c(1/1000, 1/10000),
                        labels=c("some or high risk", "low (but not zero) risk"))

## minimum costs 
min_costs <- costs %>%
    group_by(phi) %>%
    summarize(min_cost = min(maxcost),
              min_cost_dur = dur[which.min(maxcost)],
              min_cost_dur_days = min_cost_dur * gamma_params['median']) %>%
    as.matrix()

ggplot(costs, aes(x=dur*gamma_params['median'], 
                  color=phi_lab, fill=phi_lab)) + 
    geom_ribbon(aes(ymin=mincost, ymax=maxcost), alpha=.7) + 
    scale_y_continuous(breaks=c(1e5, 5e5, 10e5, 15e5, 20e5), labels=dollar,
                       expand=c(0,0),
                       name='Cost range of monitoring 100 individuals') +
    scale_x_continuous(name='Duration of active monitoring (in days)', expand = c(0, 0)) +
    coord_cartesian(xlim=c(5, 43)) +
    scale_fill_manual(values=c("#e41a1c", "#377eb8")) +
    scale_color_manual(values=c("#e41a1c", "#377eb8")) +
    geom_segment(aes(x=-100, xend=min_costs[1, "min_cost_dur_days"], 
                     y=min_costs[1, "min_cost"], yend=min_costs[1, "min_cost"]), 
                 linetype=2, color="#377eb8") +
    geom_segment(aes(x=min_costs[1, "min_cost_dur_days"], xend=min_costs[1, "min_cost_dur_days"], 
                     y=-1000, yend=min_costs[1, "min_cost"]), 
                 linetype=2, color="#377eb8") +
    geom_segment(aes(x=-100, xend=min_costs[2, "min_cost_dur_days"], 
                     y=min_costs[2, "min_cost"], yend=min_costs[2, "min_cost"]), 
                 linetype=2, color="#e41a1c") +
    geom_segment(aes(x=min_costs[2, "min_cost_dur_days"], xend=min_costs[2, "min_cost_dur_days"], 
                     y=-10000, yend=min_costs[2, "min_cost"]), 
                 linetype=2, color="#e41a1c") +
    theme(legend.title=element_blank(), legend.position=c(.8, .8))
    #geom_vline(xintercept=as.numeric(min_costs[1, "min_cost_dur_days"]), linetype=2, color="#377eb8") +
    #geom_vline(xintercept=as.numeric(min_costs[2, "min_cost_dur_days"]), linetype=2, color="#e41a1c") +
    ## geom_hline(yintercept=1900000) + 
    ## geom_hline(yintercept=opt_10K$objective, linetype=2) +
    ## geom_hline(yintercept=opt_1K$objective, linetype=2) +
    ## ggtitle("Estimated cost ranges of monitoring 100 individuals at two risk levels")
```


```{r optimized-cost-with-uncertainty, cache=FALSE}
durs <- seq(.5, 5, by=.1)
phis <- c(1/1000, 1/10000)

nsamp <- 10000
sampled_idx <- sample.int(nrow(pstr_gamma_params_ebola), 
                          size=nsamp, replace=FALSE)
sampled_params <- as.matrix(pstr_gamma_params_ebola[sampled_idx, c("median", "shape", "scale")])

## run optimization over a sample from posterior
for (i in 1:nsamp) {
  tmp <- calc_monitoring_costs(durs = durs,
                               probs_of_disease = phis,
                               per_day_hazard = per_day_hazard,
                               N = 100,
                               cost_mat = cost_mat,
                               gamma_params = sampled_params[i,], 
                               return_scalar=FALSE)
  
  ## calculate minimum max cost for this sample
  tmp_sampled_costs <- tmp %>%
    group_by(phi) %>%
    summarize(min_cost = min(maxcost),
              min_cost_dur = dur[which.min(maxcost)],
              min_cost_dur_days = min_cost_dur * gamma_params['median']) %>%
    as.matrix()
  if (i == 1) {
    min_sampled_costs <- tmp_sampled_costs
  } else {
    min_sampled_costs <- rbind(min_sampled_costs, tmp_sampled_costs)
  }
}

min_sampled_costs <- as_data_frame(min_sampled_costs)
min_sampled_costs$phi_lab <- factor(min_sampled_costs$phi, 
                              levels=c(1/1000, 1/10000),
                              labels=c("some or high risk", "low (but not zero) risk"))

#quantile(min_sampled_costs$min_cost_dur, probs=c(.05, .5, .95))
#quantile(min_sampled_costs$min_cost_dur_days, probs=c(.05, .5, .95))
#quantile(min_sampled_costs$min_cost, probs=c(.05, .5, .95))

aa <- min_sampled_costs %>% group_by(phi, phi_lab) %>%
  do(broom::tidy(t(quantile(.$min_cost, probs=c(.025, .5, .975)))))
## min_cost_dur is sensitive to the sampled parameters
## by using min_cost_dur_days, we keep it on a common scale
#bb <- min_sampled_costs %>% group_by(phi, phi_lab) %>%
#  do(broom::tidy(t(quantile(.$min_cost_dur, probs=c(.05, .5, .95)))))
min_cost_days_distr <- min_sampled_costs %>% group_by(phi, phi_lab) %>%
  do(broom::tidy(t(quantile(.$min_cost_dur_days, probs=c(.025, .5, .975))))) %>%
  as.data.frame()

```


Our model provides ranges of expected cost for active monitoring systems. It identifies an optimal duration of active monitoring, by finding the expected cost range with the lowest maximum value. We applied the model to the case-study of Ebola in NYC, based on data from DOHMH (Table 1, Figure 4). Expected costs of short periods of active monitoring (left hand side of Figure 4) are driven by the cost of a missed case and the number of expected additional secondary cases, while the rate of decline with additional days of monitoring is driven by the shape of the incubation period distribution. The costs of longer periods of active monitoring are driven by the per day cost of monitoring and costs of false positive detections (right hand side of Figure 4).

For the low-risk individuals, the model suggests that the cost is minimized with 
`r round(min_costs[which(min_costs[,"phi"]==1e-4), "min_cost_dur_days"],1)` 
days of monitoring (i.e.,
`r round(min_costs[which(min_costs[,"phi"]==1e-4), "min_cost_dur_days"]/mean(pstr_gamma_params_ebola$median),1)` 
median incubation periods, 95% CI = 
`r round(min_cost_days_distr[which(min_cost_days_distr[,"phi"]==1e-4), "X2.5."],1)` 
-
`r round(min_cost_days_distr[which(min_cost_days_distr[,"phi"]==1e-4), "X97.5."],1)`). 
For the some- or high-risk individuals, the model suggests that the cost is minimized with 
`r round(min_costs[which(min_costs[,"phi"]==1e-3), "min_cost_dur_days"],1)` 
days of monitoring 
(i.e.,
`r round(min_costs[which(min_costs[,"phi"]==1e-3), "min_cost_dur_days"]/mean(pstr_gamma_params_ebola$median),1)` 
median incubation periods, 95% CI = 
`r round(min_cost_days_distr[which(min_cost_days_distr[,"phi"]==1e-3), "X2.5."],1)` 
-
`r round(min_cost_days_distr[which(min_cost_days_distr[,"phi"]==1e-3), "X97.5."],1)`) 
(Figure 4). The model results are sensitive to the assumed cost per day of monitoring and the number of secondary cases. For example, if the upper limit of the cost increases from $20 to $40/day or the number of secondary cases decreases from 4 to 2, the durations of monitoring that would minimize expected cost decrease by 2-3 days for each scenario.

# Discussion

For three pathogens of significant public health concern, we quantified the risk, costs, and attendant uncertainty associated with specific durations of active monitoring. The approach presented can be used to develop empirically based public health policies in future outbreaks. 

Perception of risk is a key component of decision making, but ultimately science should inform public health policies. A key challenge faced by decision makers is that the public's perception of risk is often determined by the consequences of the event even if the probability of the event occurring is rare. With severe diseases, the consequences may be perceived as so dire that the public's tolerance for risk will be very low. While no policy can guarantee zero risk, analyses such as those presented here can assist in determining appropriate thresholds that reduce risk below a level tolerable for a risk-averse population.

In some settings, active monitoring could serve as an alternative to quarantine, which involves both monitoring and severe restrictions on movement. In countries at low risk for Ebola, quarantine raised many ethical issues during the West Africa Ebola outbreak.[@Drazen:2014iz] CDC’s Ebola active monitoring recommendations were therefore a critical cornerstone of the public health response in the United States that strived to balance the concerns from a diverse set of stakeholders without unnecessarily restricting individual liberties.[@CentersforDiseaseControlandPrevention:lyxYF_Hp] 
Active monitoring has since been applied by DOHMH for an individual at risk for another acute viral illness, Lassa fever. 
However, for diseases in which asymptomatic persons may transmit infection –such as influenza or measles– detection of the cases based on active monitoring of symptomology might not be soon enough to prevent secondary transmission.  As such, for these diseases, quarantine might be a more appropriate public health measure.

Our model suggests durations of active monitoring for emerging pathogens early in an outbreak. Accurate estimates of the median incubation period can be made even when few data are available.[@Reich:2009jq] While accurately estimating the variability of the incubation period requires more data[@WorldHealthOrganization:QuWKXo2f], existing data on the variation observed in similar pathogens could be used to inform early estimates until better data become available. When estimating incubation periods in real-time, care must be taken to adjust for possible truncation of longer incubation periods [@Brookmeyer:2001gx;@Nishiura:2011dc] or selection biases that could favor reporting of shorter incubation periods [@Virlogeux:2016ty]. 

While our model explicitly propagates uncertainty in the incubation period distribution, public health practitioners will usually have too little data to estimate uncertainty for other model parameters. To help account for this limitation, we ran the model for plausible ranges of other parameters, presenting a range of possible costs and risks. Sensitivity to these and other assumptions can be assessed through the open-access web applet that implements the model.

Evaluating the cost of monitoring programs is a challenging, multi-faceted problem. While we present new data from New York City's active monitoring program showing that the per-individual cost of monitoring is "low" (about $10–$20 per day), the total program cost can be substantial. Limiting who needs to be monitored and the duration of monitoring could provide valuable savings. 

We present a framework for assessing the cost of active monitoring, which is one possible public health strategy for combating an emerging epidemic. However, alternate strategies such as quarantine, pharmaceutical interventions, or increasing risk communication could also be implemented. These different interventions could also be assessed under a similar framework to that presented here.

Some cost-efficiency may be achieved through targeted strategies. As CDC recommended for Ebola, it may be appropriate to use exposure-risk categories to modify the duration or intensity of active monitoring. Additionally, stronger public health messaging could encourage travelers to take necessary health precautions to avoid common travel-associated illnesses, e.g. malaria.[@Ezeoke:2016jv] This, in turn, could reduce unnecessary testing and costs associated with symptomatic events with diseases other than the one of interest. Low-cost versions of active monitoring have the potential to add value to public health response to less severe outbreaks as well. 

Accurately estimating the risk of developing disease within exposure-risk categories poses a challenge to public health officials. Our analyses show that the sensitivity to mis-specified risk varies by pathogen. When the estimated cost varies across plausible risk levels, the full range of potential costs and durations should be considered until better data are available to obtain more precise estimates of the risk. 

The framework presented is generally applicable, but given the lack of empirical cost information for the response to and monitoring of smallpox and MERS-CoV our analysis is strongly focused on Ebola. While we have used some of the best available data on large-scale active monitoring programs in our analyses, some potential costs and savings were not factored in to these calculations. The estimates available from DOHMH do not include the costs of cell phones given to monitored individuals, the staff time incurred by CDC and US Department of Homeland Security in screening travelers at airports, and the costs of evaluating individuals with symptoms that were not due to Ebola. More detailed cost data was not available from DOHMH, but such data could help to disentangle the fixed costs associated with running an active monitoring program from the cost per monitored individual. Additionally, we only presented gross cost estimates for the evaluation of a symptomatic individual under active monitoring from one NYC hospital, which was not representative of all hospitals in NYC. Finally, local considerations prompted DOHMH to opt for an active monitoring program involving humans to make and receive active monitoring reports from individuals. In contrast, other jurisdictions used digital systems to administer monitoring reports.[@Parham:2015wf] The merits of these different approaches deserve further investigation. 

Recent history has shown that the unexpected emergence of new disease threats has become a recurring theme in global health and preparedness. While active monitoring does not play a role in the response to every emerging infectious disease (e.g., it has not played an important role in the response to the Zika virus epidemic), it will likely be used again in the response to future threats. Our framework provides valuable information for assessing the cost-effectiveness of various active monitoring strategies in response to critical disease outbreaks. By providing an empirical basis for evaluating active monitoring programs, these tools can strengthen biosecurity and optimize active monitoring programs in response to future global disease threats.

# Acknowledgments
We thank the individuals who underwent active monitoring in NYC, Ifeoma Ezeoke for preparing the DOHMH active monitoring data and Margaret Pletnikoff for preparing the DOHMH cost data. We thank Dr. Simon Cauchemez, Dr. Ousmane Faye, and Dr. Amadou Sall for providing access to the Ebola incubation period data from Guinea and giving permission for this data to be made publicly available. We also acknowledge John Maher for providing details on costs of evaluating Ebola patients at Bellevue Hospital in New York City.

NGR was funded by a grant from the MIDAS program of the National Institutes of General Medical Sciences (R35GM119582). The findings and conclusions in this article are those of the authors and do not necessarily represent the official position of DOHMH, CDC, NIGMS, or the National Institutes of Health. 

# Author Contributions
NGR, JL, JKV, and NMV designed the study. NMV and JKV oversaw the active monitoring data collection and provided data for the study on active monitoring programs. NGR obtained incubation period data from existing publications and via personal communication with other authors. NGR ran the data analysis, prepared the figures, and drafted the manuscript. All authors participated in writing and providing substantial feedback on the manuscript.

# Competing Financial Interests
All authors claim no competing financial interests associated with this work.

# Tables

```{r print-the-table, results='asis'}
kable(out, 
      caption="Total expected costs to the public health system (including active monitoring and response) per 100 monitored individuals, at two exposure-risk categories. Columns represent multiples of the median incubation period of Ebola. Rows represent the CDC exposure-risk category. Costs are inclusive of active monitoring and public health response and are based on model outputs for Ebola. Values are in $'000s.")
```

\clearpage

# Figures

__Figure 1__ Model schematic representing four outcome scenarios for a person under active monitoring. Estimated costs shown are based on published costs[@Yacisin:2015wm] as well as new data from DOHMH and Bellevue Hospital in NYC. Details on the model formulation are available in Supplemental Table 3. Our model uses probabilities to calculate the likelihood of each of the possible model outcomes. Additionally, we estimate the probability that an individual who does not develop the disease of interest develops symptomatic illness necessitating hospitalization to rule-out the disease of interest. (See Supplemental Text for details.) 

![](static-figures/figure1-model-schema-v9.jpg)
<!-- static-figures/figure1-model-schema-v9.jpg-->

\ 
\clearpage

__Figure 2__ Estimates and credible regions for incubation period distributions for Ebola, MERS-CoV and smallpox. The shaded elliptical areas represent regions that contain 95% of the estimated posterior distributions for each of the three diseases. The disease-specific curves plotted on the right show the estimated distribution for the incubation period for each disease (dark line). To show some of the uncertainty associated with these estimates, a random selection of density functions sampled from the joint posterior are represented by colored transparent lines around the heavy lines. Shaded vertical bands indicate the marginal credible regions for the median and 95th percentile. 

![](static-figures/figure2-estimated-distribution-dynamic-5.pdf)
<!--static-figures/figure2-estimated-distribution-dynamic-5.pdf-->

\ 

\clearpage

__Figure 3__ Estimated probabilities of symptoms occurring after active monitoring (AM) ends across different active monitoring period durations, shown as multiples of the median incubation period. Figures are shown for 'some or high risk' and 'low (but not zero) risk' scenarios, with probabilities of developing symptomatic infection set to 1/1,000 and 1/10,000, respectively. The vertical dashed line indicates the 21 day duration recommended for Ebola active monitoring (i.e., approximately 2.4 times the median incubation period of Ebola).

![](static-figures/figure3-scaled-prob-symptoms-1.pdf)
<!--static-figures/figure3-scaled-prob-symptoms-1.pdf-->

\ 
\clearpage

__Figure 4__ Estimated cost ranges of actively monitoring 100 individuals for Ebola, calculated separately for some or high risk individuals and low (but not zero) risk individuals. The dashed lines intersect at the minimum point for the upper limit of each cost range. 

![](static-figures/figure4-optimized-cost-analysis-1.pdf)
<!--static-figures/figure4-optimized-cost-analysis-1.pdf-->

# Bibliography
